<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="img/favicon.ico">
  <title>Services - Application Container Platform</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="css/theme.css" type="text/css" />
  <link rel="stylesheet" href="css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Services";
    var mkdocs_page_input_path = "services.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="js/jquery-2.1.1.min.js" defer></script>
  <script src="js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="index.html" class="icon icon-home"> Application Container Platform</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="index.html">Home</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="services.html">Services</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#vpn">VPN</a></li>
    

    <li class="toctree-l2"><a href="#source-code-management">Source Code Management</a></li>
    

    <li class="toctree-l2"><a href="#ci">CI</a></li>
    

    <li class="toctree-l2"><a href="#binary-artifact-storage">Binary / Artifact Storage</a></li>
    

    <li class="toctree-l2"><a href="#domain-name-system-dns-pattern">Domain Name System (DNS) Pattern</a></li>
    

    <li class="toctree-l2"><a href="#application-composition">Application Composition</a></li>
    

    <li class="toctree-l2"><a href="#logging">Logging</a></li>
    

    <li class="toctree-l2"><a href="#metrics-monitoring">Metrics / Monitoring</a></li>
    

    <li class="toctree-l2"><a href="#security-and-disaster-recovery">Security and disaster recovery</a></li>
    

    <li class="toctree-l2"><a href="#reusable-components">Reusable components</a></li>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="releases-notes/index.html">Release Notes</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="how-to-docs/index.html">How To's</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="developer-docs/index.html">Developer Getting Started Guide</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="newuser.html">New User Guide</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="rbac.html">RBAC Guide</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="external-addresses.html">ACP External IPs</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="service-lifecycle.html">Service Lifecycle</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Application Container Platform</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
    
      
    
    <li>Services</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <p>These are the core services which we provide across our platform.</p>
<h2 id="vpn">VPN<a class="headerlink" href="#vpn" title="Permanent link">#</a></h2>
<p>Many of our services are behind a VPN (using <a href="https://wiki.archlinux.org/index.php/OpenVPN">OpenVPN</a> protocol) for security reasons. We have many different roles and profiles for accessing different environments. These profiles are all found at <a href="https://access-acp.digital.homeoffice.gov.uk">Access ACP</a>.
You can download VPN profiles for the environments you have access to. New profiles can be set up to connect through to things like project specific AWS accounts.
Each profile will expire after a certain amount of time (2-12 hours), users will have to download a new profile once their certificates which are baked into the openvpn profiles expire.</p>
<h2 id="source-code-management">Source Code Management<a class="headerlink" href="#source-code-management" title="Permanent link">#</a></h2>
<h4>GitHub</h4>
<p>GitHub is where we store our open source code. You need to be added to the Uk HomeOffice organisation to access most of our code. More documentation can be found <a href="https://help.github.com/">here</a></p>
<h4>GitLab</h4>
<p><a href="https://gitlab.digital.homeoffice.gov.uk">GitLab</a> is where we store our more private code. Hosted in our ops cluster, you will need an office 365 account to get in via single sign on. Each project has its own group which are managed by members of that project. More in depth guides to gitlab can be found <a href="https://docs.gitlab.com/ce/README.html">here</a>.</p>
<h2 id="ci">CI<a class="headerlink" href="#ci" title="Permanent link">#</a></h2>
<h4>Drone</h4>
<p>Drone is our CI tool for building and deploying applications. We have two instances, one for <a href="https://drone-gitlab.acp.homeoffice.gov.uk">GitLab</a> and one for <a href="https://drone.acp.homeoffice.gov.uk">GitHub</a>. More instructions can be found <a href="how-to-docs/drone-how-to.html">here</a>.</p>
<h4>Jenkins</h4>
<p>Jenkins is considered a legacy system and is not supported.</p>
<h2 id="binary-artifact-storage">Binary / Artifact Storage<a class="headerlink" href="#binary-artifact-storage" title="Permanent link">#</a></h2>
<h4>Quay</h4>
<p><a href="https://quay.io/ukhomeofficedigital">Quay</a> is where store all of our open source container images.</p>
<h4>ECR</h4>
<p>We use AWS ECR to host our private container images for high availability and resiliency. For more information on how to use ECR see <a href="how-to-docs/drone-how-to.html">here</a></p>
<h4>Artifactory</h4>
<p>We use <a href="https://artifactory.digital.homeoffice.gov.uk">Artifactory</a> as our internal binary repository store, projects can push build artifacts / dependencies here. Prior to the introduction of ECR, docker images were also push here, and can be access via https://docker.digital.homeoffice.gov.uk, log in via the Office 365 button to view your artifacts.</p>
<h2 id="domain-name-system-dns-pattern">Domain Name System (DNS) Pattern<a class="headerlink" href="#domain-name-system-dns-pattern" title="Permanent link">#</a></h2>
<p>To standardise on how services route their application traffic to the appropriate hosting platform and to offer consistency in how we approach DNS we have a standard DNS naming convention for services.</p>
<p>In parallel to this, users need to also be aware of <a href="how-to-docs/certificates.html">the limits on certificates and letsencrypt</a> if they are wanting external TLS certificates for their services.</p>
<h4>For Non-production Services</h4>
<p>The following categories are something we would expect a service to specify:</p>
<p><code>Service Name</code> - The name of the service users or other services will attempt to consume i.e. <code>web-portal</code></p>
<p><code>Env</code> - The environment of the service i.e. <code>Dev</code></p>
<p><code>Service</code> - The overall service name or project name i.e. <code>example-service</code></p>
<pre><code>&lt;servicename&gt;.&lt;env&gt;.&lt;service&gt;-notprod.homeoffice.gov.uk

web-portal.dev.example-service-notprod.homeoffice.gov.uk
</code></pre>

<h4>For Production Services</h4>
<p>As we want to protect production services from hitting limits and to create a distinction between services that are non-production, (not prod)  and production, we simplify the overall approach by using the main service name as the domain.</p>
<p><code>Service Name</code> - The name of the service users or other services will attempt to consume i.e. <code>web-portal</code></p>
<p><code>Service</code> - The overall service name or project name i.e. <code>example-service</code></p>
<pre><code>&lt;servicename&gt;.&lt;service&gt;.homeoffice.gov.uk

web-portal.example-service.homeoffice.gov.uk
</code></pre>

<h2 id="application-composition">Application Composition<a class="headerlink" href="#application-composition" title="Permanent link">#</a></h2>
<p>The following are containers that we create for use alongside your own application</p>
<h4>Keycloak Gatekeeper</h4>
<p><a href="https://github.com/keycloak/keycloak-gatekeeper">Keycloak Proxy</a>: a container for putting auth in front of your application.</p>
<h4>Nginx Proxy</h4>
<p><a href="https://github.com/UKHomeOffice/docker-nginx-proxy">Nginx Proxy</a>: for TLS and proxying your application container.</p>
<h4>cfssl Sidekick</h4>
<p><a href="https://github.com/UKHomeOffice/cfssl-sidekick">cfssl-sidecar</a>: for providing a server TLS cert on demand from a cluster hosted cfssl server.</p>
<h2 id="logging">Logging<a class="headerlink" href="#logging" title="Permanent link">#</a></h2>
<p>Logging stack consists of <a href="https://github.com/UKHomeOffice/docker-elasticsearch">Elasticsearch</a>, <a href="https://github.com/UKHomeOffice/docker-logstash-kubernetes">Logstash</a>, <a href="https://github.com/UKHomeOffice/docker-kibana">Kibana</a>).</p>
<ul>
<li>Logstash agents deployed as a daemonSet will collect all workload logs and index them in Elasticsearch.</li>
<li>Logs are searchable for a period of 5 days through <a href="https://kibana.acp.homeoffice.gov.uk">Kibana UI</a>. Access to view logs can be requested via <a href="https://hub.acp.homeoffice.gov.uk/help/support/requests/new/kibana-access-request">Support request</a>.</li>
</ul>
<h4>Current Log Retention Policy</h4>
<ul>
<li>Logs are searchable in Kibana for 5 days and remain within Elasticsearch for 10 days.</li>
<li>Collected workload logs will be persisted in S3 indefinitely and migrated to the infrequent access storage class and then glacier storage after 60 and 180 days respectively. <strong>NOTE: this may change in the future!</strong></li>
<li>The same policy applies to all logs within ELK</li>
</ul>
<h2 id="metrics-monitoring">Metrics / Monitoring<a class="headerlink" href="#metrics-monitoring" title="Permanent link">#</a></h2>
<h4>Sysdig</h4>
<p><a href="https://sysdig.digital.homeoffice.gov.uk">Sysdig</a> is our metric collection tool. We are working closely with Sysdig on the development of this. It can be used for dashboards, alerting and much more. More information can be found on the <a href="https://sysdig.com">Sysdig Monitor site</a> and for the open-source tool, <a href="http://sysdig.org">Sysdig</a> (command line tool) and <a href="https://github.com/draios/sysdig-inspect">Sysdig Inspect</a>.</p>
<h4>Sysdig training</h4>
<p>Sysdig have an online training course which covers the basics of using the product, <a href="https://sysdig.teachable.com/">Sysdig 101</a>. Sysdig recommends new users complete this training.</p>
<h2 id="security-and-disaster-recovery">Security and disaster recovery<a class="headerlink" href="#security-and-disaster-recovery" title="Permanent link">#</a></h2>
<p>The Application Container Platform employs robust security principles, including but not limited to:</p>
<ul>
<li>encryption of data at rest and in transit</li>
<li>restricting access to resources according to operational needs</li>
<li>strict authorisation requirements for all endpoints</li>
<li><a href="rbac.html">role based access control</a></li>
</ul>
<p>The Platform is spread across multiple availability zones, which are essentially three different data centres within a region. In case of an entire AWS region going down for a prolonged period of time, the Platform can be recreated in another region within a few hours.</p>
<p>The recovery of products hosted on the Platform are subject to considerations set out for the Production Ready criteria in <a href="service-lifecycle.html">Service Lifecycle</a>.</p>
<p>For further information on security and disaster recovery considerations, please raise a ticket on the <a href="https://github.com/UKHomeOffice/application-container-platform-bau/issues">BAU Board</a>.</p>
<h2 id="reusable-components">Reusable components<a class="headerlink" href="#reusable-components" title="Permanent link">#</a></h2>
<p>Whilst building ACP, we've written a things that other projects may be interested in reusing. These can be found on GitHub here</p>
<h4>Terraform modules</h4>
<p>https://github.com/UKHomeOffice?utf8=%E2%9C%93&amp;q=acp-tf&amp;type=&amp;language=</p>
<h4>Base docker images</h4>
<p>https://github.com/UKHomeOffice?utf8=%E2%9C%93&amp;q=docker-&amp;type=&amp;language=</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="releases-notes/index.html" class="btn btn-neutral float-right" title="Release Notes">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Home"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="index.html" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="releases-notes/index.html" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '.';</script>
    <script src="js/theme.js" defer></script>
      <script src="search/main.js" defer></script>

</body>
</html>
